//______________________________________________________________________________
// ls_chol_tb.cpp
//
//
// a. paek jan 2014
//______________________________________________________________________________

// for armadillo
//#include <iostream>
//#include "C:/data/design_math/armadillo-3.930.2/include/armadillo"
//using namespace arma;

#include "ls_chol.h"
using namespace std;

//______________________________________________________________________________
int main (){

TC_hls A[M][N];
TC_hls Y[M];
TC_hls X[N];
TC_hls X_ideal[N];

  A[0][0] = TC_hls(0.417022004702574, 0.800744568675537);
  A[1][0] = TC_hls(0.720324493442158, 0.968261575719398);
  A[2][0] = TC_hls(0.000114374817345, 0.313424178159243);
  A[3][0] = TC_hls(0.302332572631840, 0.692322615669314);
  A[4][0] = TC_hls(0.146755890817113, 0.876389152296038);

  A[0][1] = TC_hls(0.092338594768798, 0.894606663503847);
  A[1][1] = TC_hls(0.186260211377671, 0.085044211369778);
  A[2][1] = TC_hls(0.345560727043048, 0.039054783232882);
  A[3][1] = TC_hls(0.396767474230670, 0.169830419564569);
  A[4][1] = TC_hls(0.538816734003357, 0.878142503429413);

  A[0][2] = TC_hls(0.419194514403295, 0.098346833833050);
  A[1][2] = TC_hls(0.685219500396760, 0.421107625005052);
  A[2][2] = TC_hls(0.204452249731517, 0.957889530150502);
  A[3][2] = TC_hls(0.878117436390945, 0.533165284973017);
  A[4][2] = TC_hls(0.027387593197926, 0.691877113950473);

  A[0][3] = TC_hls(0.670467510178402, 0.315515631006063);
  A[1][3] = TC_hls(0.417304802367127, 0.686500927681584);
  A[2][3] = TC_hls(0.558689828445752, 0.834625671897373);
  A[3][3] = TC_hls(0.140386938595234, 0.018288277344192);
  A[4][3] = TC_hls(0.198101489084879, 0.750144314944967);
  
  
  Y[0] = TC_hls(1, 0);
  Y[1] = TC_hls(2, 0);
  Y[2] = TC_hls(3, 0);
  Y[3] = TC_hls(4, 0);
  Y[4] = TC_hls(5, 0);

  X_ideal[0] = TC_hls(0.203789804343599, 4.211478891623711);
  X_ideal[1] = TC_hls(1.564921331366457, -4.425635623788000);
  X_ideal[2] = TC_hls(5.365260732386592, -2.793937994513788);
  X_ideal[3] = TC_hls(-3.233304302545397,-2.122207691518969);

  for (int i=0;i<8;i++)
    ls_chol(X, A, Y);

  //cout << endl << endl << "A :" << endl;
  //print_mat<M,N,TC_hls>(A);

  //cout << endl << endl << "X recovered:" << endl;
  //print_mat<N,TC_hls>(X);
  //cout << endl;

  TC_hls df[N];

  for (int i=0;i<N;i++) {
    df[i] = X_ideal[i] - X[i];
    cout << endl << "difference[" << i << "] = " << df[i];
  }
  cout <<endl<<endl;


  return 0;

}
